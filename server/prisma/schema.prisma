generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Users {
  id       Int      @id @default(autoincrement())
  username String
  email    String
  password String
  lyrics   Lyrics[]
}

model Lyrics {
  id             Int              @id @default(autoincrement())
  owner          Users            @relation(fields: userId, references: id)
  message        Message[]
  user           UserLyric[]
  chat           Chat[]
  date           DateTime
  editDate       DateTime
  isPinned       Boolean
  isChannelPost  Boolean
  replyToMessage ReplyToMessage[]
  media          Media[]

  userId Int
}

model UserLyric {
  key         Int     @id @default(autoincrement())
  id          BigInt
  username    String?
  displayName String?
  isAdmin     Boolean
  lyrics      Lyrics  @relation(fields: lyricId, references: id)

  lyricId Int
}

model Chat {
  key   Int    @id @default(autoincrement())
  id    BigInt
  title String
  type  String
  lyric Lyrics @relation(fields: lyricId, references: id)

  lyricId Int
}

model Media {
  id       Int     @id @default(autoincrement())
  mime     String
  duration Int
  convert  Boolean
  lyric    Lyrics  @relation(fields: lyricId, references: id)

  lyricId Int
}

model Message {
  id              Int         @id @default(autoincrement())
  text            String?
  word_count      Int?
  paragraph_count Int?
  reactions       Reactions[]
  hashtags        Hashtags[]
  lyric           Lyrics      @relation(fields: lyricId, references: id)

  lyricId    Int
  reactionId Int?
  hashtagsId Int?
}

model Hashtags {
  id       Int      @id @default(autoincrement())
  message  Message  @relation(fields: messageId, references: id)
  count    Int
  hashtags String[]

  messageId Int
}

model Reactions {
  id             Int     @id @default(autoincrement())
  message        Message @relation(fields: messageId, references: id)
  Emoji          Emoji[]
  uniqueCount    Int
  totalFreeCount Int
  totalPaidCount Int
  totalCount     Int

  messageId Int
}

model Emoji {
  id       Int       @id @default(autoincrement())
  emoji    String
  isPaid   Boolean
  count    Int
  order    Int?
  reaction Reactions @relation(fields: reactionId, references: id)

  reactionId Int
}

model ReplyToMessage {
  id    Int    @id @default(autoincrement())
  lyric Lyrics @relation(fields: lyricId, references: id)

  lyricId Int
}
