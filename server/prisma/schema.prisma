generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id          Int     @id @default(autoincrement())
  username    String?
  displayName String?
  owner       Int?
  isAdmin     Boolean
  lyrics      Lyric[]
}

model Lyric {
  id             Int              @id @default(autoincrement())
  message        Message[]
  user           User             @relation(fields: id, references: id)
  chat           Chat[]
  date           DateTime
  editDate       DateTime
  isPinned       Boolean
  isChannelPost  Boolean
  replyToMessage ReplyToMessage[]
  media          Media[]
}

model Chat {
  id    Int    @id @default(autoincrement())
  title String
  type  String
  lyric Lyric  @relation(fields: lyricId, references: id)

  lyricId Int @unique
}

model Media {
  id       Int     @id @default(autoincrement())
  mime     String
  duration Int
  convert  Boolean
  lyric    Lyric   @relation(fields: lyricId, references: id)

  lyricId Int @unique
}

model Message {
  id             Int        @id @default(autoincrement())
  text           String?
  wordCount      Int?
  paragraphCount Int?
  reaction       Reaction[]
  hashtags       Hashtags[]
  lyric          Lyric      @relation(fields: lyricId, references: id)

  lyricId    Int  @unique
  reactionId Int? @unique
  hashtagsId Int? @unique
}

model Hashtags {
  id       Int      @id @default(autoincrement())
  message  Message  @relation(fields: messageId, references: id)
  count    Int
  hashtags String[]

  messageId Int
}

model Reaction {
  id             Int     @id @default(autoincrement())
  message        Message @relation(fields: messageId, references: id)
  Emoji          Emoji[]
  uniqueCount    Int
  totalFreeCount Int
  totalPaidCount Int
  totalCount     Int

  messageId Int @unique
}

model Emoji {
  id       Int      @id @default(autoincrement())
  emoji    String
  isPaid   Boolean
  count    Int
  reaction Reaction @relation(fields: reactionId, references: id)

  reactionId Int @unique
}

model ReplyToMessage {
  id    Int   @id @default(autoincrement())
  lyric Lyric @relation(fields: lyricId, references: id)

  lyricId Int @unique
}
